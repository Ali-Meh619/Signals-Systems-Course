function     y=kirsch(A)


G(:,:,1)=[5 5 5;-3 0 -3;-3 -3 -3];
G(:,:,2)=[5 5 -3;5 0 -3;-3 -3 -3];
G(:,:,3)=[5 -3 -3;5 0 -3;5 -3 -3];
G(:,:,4)=[-3 -3 -3;5 0 -3;5 5 -3];
G(:,:,5)=[-3 -3 -3;-3 0 -3;5 5 5];
G(:,:,6)=[-3 -3 -3;-3 0 5;-3 5 5];
G(:,:,7)=[-3 -3 5;-3 0 5;-3 -3 5];
G(:,:,8)=[-3 5 5;-3 0 5;-3 -3 -3];

	r1 = size(A,1);
	r2 = size(A,2);
	
    a=fft2(A);
    
   for k=1:8
	g=fft2(G(:,:,k),r1,r2);
       
    s(:,:,k)=a.*g;
    
    S(:,:,k)=ifft2(s(:,:,k));
       
       
       
   end
   
   for j=1:size(S,2)
       
              for k=1:size(S,1)
                                 
           for i=1:8
   
               
               b(i,1)=S(k,j,i);
               
               
           end
              mag(k,j)=max(b);
              end
              end
   

 y=mat2gray(mag);
end